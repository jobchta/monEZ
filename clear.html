<!DOCTYPE html>
<html>

<head>
    <title>Clear Cache - monEZ</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 500px;
            margin: 50px auto;
            padding: 20px;
            text-align: center;
        }

        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            background: #f0f0f0;
        }
    </style>
</head>

<body>
    <h1>üîÑ Clear monEZ Cache</h1>
    <p>Click the button below to clear all cached data and reload the latest version.</p>

    <button class="btn" onclick="clearAll()">Clear Cache & Reload</button>

    <div class="status" id="status">Ready to clear cache</div>

    <script>
        async function clearAll() {
            const status = document.getElementById('status');

            try {
                status.textContent = '1/4 Unregistering service workers...';

                // Unregister all service workers
                const registrations = await navigator.serviceWorker.getRegistrations();
                for (let registration of registrations) {
                    await registration.unregister();
                }

                status.textContent = '2/4 Clearing caches...';

                // Clear all caches
                const cacheNames = await caches.keys();
                await Promise.all(cacheNames.map(name => caches.delete(name)));

                status.textContent = '3/4 Clearing storage...';

                // Clear localStorage
                localStorage.clear();

                // Clear sessionStorage
                sessionStorage.clear();

                status.textContent = '4/4 Redirecting to monEZ...';

                // Wait a bit then redirect
                setTimeout(() => {
                    window.location.href = 'https://jobchta.github.io/monEZ/';
                }, 1000);

            } catch (error) {
                status.textContent = '‚ùå Error: ' + error.message;
                status.style.background = '#ffebee';
            }
        }
    </script>
</body>

</html>